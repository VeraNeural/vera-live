# VERA Penetration Testing Scope Document

> **Document ID:** SEC-PENTEST-001  
> **Version:** 1.0  
> **Classification:** Confidential  
> **Last Updated:** January 25, 2026  

---

## 1. Engagement Overview

### 1.1 Application Description

VERA is a trauma-informed AI mental health support application providing:

| Feature | Description |
|---------|-------------|
| Conversational AI Support | Claude-powered chat interface for mental health conversations |
| User Authentication | Clerk-based authentication with MFA support |
| Subscription Management | Stripe-powered billing with free/paid tiers |
| Voice Interaction | Hume-powered voice features |
| Memory/Personalization | AI-driven memory and continuity features |
| Sanctuary Mode | Premium emotional continuity features |
| Professional Access | Therapist/professional companion features |

### 1.2 Business Criticality

| Factor | Rating | Notes |
|--------|--------|-------|
| User Data Sensitivity | **CRITICAL** | Mental health conversations, trauma disclosure |
| Financial Data | **HIGH** | Stripe payment processing |
| PII Exposure | **HIGH** | Names, emails, preferences |
| Regulatory Scope | **HIGH** | GDPR, CCPA, HIPAA-aligned |
| Reputation Risk | **CRITICAL** | Vulnerable user population |

### 1.3 Special Considerations

⚠️ **VERA serves users in vulnerable mental health states. Any security incident could have serious real-world consequences beyond typical data breach impacts.**

---

## 2. Scope Definition

### 2.1 In-Scope Assets

| Asset | Type | URL/Location | Priority |
|-------|------|--------------|----------|
| Web Application | Primary | https://vera.ai | Critical |
| Chat API | Primary | /api/chat-claude | Critical |
| Authentication | Primary | /api/auth/*, Clerk integration | Critical |
| User Data APIs | Primary | /api/user/*, /api/export-my-data, /api/delete-my-account | Critical |
| Payment Integration | Primary | /api/stripe/* | Critical |
| Admin Panel | Secondary | /admin/* | Critical |
| Assessment Flow | Secondary | /assessment/* | High |
| Sanctuary Features | Secondary | /sanctuary/*, /api/sanctuary/* | High |
| Voice Features | Secondary | /voice/*, /api/voice/* | Medium |
| Professional Portal | Secondary | /professionals/* | Medium |

### 2.2 In-Scope Testing Types

| Test Type | Included | Notes |
|-----------|----------|-------|
| Web Application Testing (OWASP Top 10) | ✅ | Full coverage |
| API Security Testing | ✅ | All /api/* endpoints |
| Authentication/Authorization Testing | ✅ | Focus on RLS bypass |
| Session Management Testing | ✅ | Clerk session handling |
| Input Validation Testing | ✅ | Chat input, forms, uploads |
| Business Logic Testing | ✅ | Tier enforcement, limits |
| File Upload Testing | ✅ | Attachment handling |
| WebSocket Testing | ⚠️ | Voice features only |
| Rate Limiting Testing | ✅ | All rate-limited endpoints |
| AI Prompt Injection | ✅ | Claude integration security |

### 2.3 Out-of-Scope

| Asset/Activity | Reason |
|----------------|--------|
| Stripe Infrastructure | Third-party, tested separately |
| Supabase Infrastructure | Third-party platform |
| Vercel Edge Network | Third-party platform |
| Clerk Authentication Platform | Third-party platform |
| Anthropic Claude API | Third-party platform |
| Hume Voice Platform | Third-party platform |
| Social Engineering | Not in scope for technical test |
| Physical Security | Cloud-only infrastructure |
| Denial of Service Testing | Risk to production |
| Other Vercel Customers | Shared infrastructure |

### 2.4 Testing Restrictions

| Restriction | Details |
|-------------|---------|
| **No Destructive Testing** | Do not delete/corrupt production data |
| **Peak Hours Avoidance** | No high-volume testing 6PM-10PM EST |
| **Notification Required** | 30 minutes notice before automated scanning |
| **User Isolation** | Do not access other users' real data |
| **Immediate Stop** | Cease testing if real user data exposed |
| **No Real Crisis Data** | Do not trigger real crisis detection flows |
| **Rate Limit Respect** | Do not attempt to crash rate limiters |

---

## 3. Test Accounts

### 3.1 Account Types to Provide

| Account Type | Email | Purpose | Tier | Permissions |
|--------------|-------|---------|------|-------------|
| Free User | pentest_free@test.vera.ai | Standard testing | Free | 5 msgs/day, basic features |
| Paid User | pentest_paid@test.vera.ai | Premium testing | Paid | Unlimited, all features |
| Sanctuary User | pentest_sanctuary@test.vera.ai | Sanctuary testing | Sanctuary | Full sanctuary access |
| Professional | pentest_pro@test.vera.ai | Professional portal | Professional | Client management |
| Admin User | pentest_admin@test.vera.ai | Admin testing | Admin | Full administrative access |
| Unauthenticated | N/A | Unauthorized testing | None | Public pages only |

### 3.2 Test Data Guidelines

| Requirement | Implementation |
|-------------|----------------|
| Test Accounts Only | No real user accounts provided |
| Synthetic Data | Pre-seeded conversations with test content |
| Test Payments | Stripe test mode with test cards |
| Isolated Environment | Staging environment preferred |
| Data Reset | Environment can be reset during testing |

### 3.3 Test Payment Cards (Stripe Test Mode)

| Card Number | Scenario |
|-------------|----------|
| 4242424242424242 | Successful payment |
| 4000000000000002 | Declined |
| 4000000000009995 | Insufficient funds |
| 4000002500003155 | 3D Secure required |

---

## 4. Technical Information

### 4.1 Technology Stack

| Layer | Technology | Version | Notes |
|-------|------------|---------|-------|
| Frontend | Next.js | 15.x | App Router |
| UI Framework | React | 19.x | Server Components |
| Styling | Tailwind CSS | 3.x | |
| Backend | Next.js API Routes | 15.x | Edge + Node.js |
| Database | PostgreSQL | 15.x | Via Supabase |
| ORM/Client | Supabase JS | 2.x | With RLS |
| Authentication | Clerk | Latest | MFA supported |
| Payments | Stripe | Latest | Subscription billing |
| AI Provider | Anthropic Claude | claude-sonnet-4-20250514 | |
| Voice | Hume | Latest | Optional feature |
| Hosting | Vercel | Latest | Edge Network |
| Storage | Supabase Storage | Latest | File uploads |

### 4.2 Security Controls in Place

| Control | Status | Implementation |
|---------|--------|----------------|
| Rate Limiting | ✅ | `src/lib/rateLimiter.ts` - Redis-based |
| WAF | ✅ | Vercel Edge protection |
| CAPTCHA | ❌ | Not implemented |
| CSP Headers | ✅ | `next.config.ts` |
| CORS | ✅ | Same-origin + configured origins |
| Authentication | ✅ | Clerk JWT + session |
| Authorization | ✅ | Supabase RLS policies |
| Input Validation | ✅ | Zod schemas throughout |
| Audit Logging | ✅ | `src/lib/audit.ts` |
| Encryption at Rest | ✅ | Supabase AES-256 |
| Encryption in Transit | ✅ | TLS 1.3 |

### 4.3 Known Sensitive Endpoints

| Endpoint | Method | Sensitivity | Authentication | Notes |
|----------|--------|-------------|----------------|-------|
| `/api/auth/*` | Various | Critical | Mixed | Authentication flows |
| `/api/chat-claude` | POST | Critical | Required | AI conversation |
| `/api/user/preferences` | GET/POST | High | Required | User preferences |
| `/api/export-my-data` | POST | Critical | Required | GDPR data export |
| `/api/delete-my-account` | POST | Critical | Required | Account deletion |
| `/api/stripe/checkout` | POST | Critical | Required | Payment initiation |
| `/api/stripe/webhook` | POST | Critical | Signature | Stripe webhooks |
| `/api/stripe/portal` | POST | High | Required | Billing management |
| `/api/admin/*` | Various | Critical | Admin only | Admin functions |
| `/api/sanctuary/*` | Various | High | Required | Sanctuary features |
| `/api/voice/*` | Various | High | Required | Voice processing |

### 4.4 Rate Limiting Configuration

| Endpoint Pattern | Limit | Window | Notes |
|------------------|-------|--------|-------|
| `/api/chat-claude` | Tier-based | Per day | Free: 5, Paid: unlimited |
| `/api/auth/*` | 10 | 1 minute | Authentication endpoints |
| `/api/export-my-data` | 1 | 1 hour | Data export |
| `/api/stripe/*` | 10 | 1 minute | Payment endpoints |
| General API | 100 | 1 minute | Default limit |

---

## 5. Rules of Engagement

### 5.1 Testing Window

| Parameter | Value |
|-----------|-------|
| Start Date | [TO BE CONFIRMED] |
| End Date | [TO BE CONFIRMED] |
| Testing Hours | 9:00 AM - 5:00 PM EST (preferred) |
| After-Hours Testing | Requires advance notification |
| Weekend Testing | By arrangement only |

### 5.2 Communication

| Role | Primary Contact | Backup Contact |
|------|-----------------|----------------|
| Technical POC | [Engineering Lead] | [Senior Engineer] |
| Security POC | [Security Officer] | [Engineering Lead] |
| Executive Sponsor | [CTO/CEO] | [Security Officer] |
| Emergency (24/7) | [Phone Number] | [Alternate Phone] |

**Communication Channels:**
- Daily status: Email to security@veraneural.com
- Urgent issues: Phone + email
- Critical findings: Immediate phone call

### 5.3 Immediate Notification Required For

| Scenario | Response Time |
|----------|---------------|
| Critical vulnerability discovered | Immediate (phone) |
| Any real user data accessed | Immediate (phone) |
| System instability caused | Immediate (phone) |
| Authentication bypass | Within 1 hour |
| Data exposure potential | Within 1 hour |
| SQL injection confirmed | Within 2 hours |
| Any other High/Critical | Within 4 hours |

### 5.4 Reporting Requirements

| Deliverable | Timeline | Format |
|-------------|----------|--------|
| Critical findings | Within 24 hours | Email + call |
| High findings | Within 48 hours | Email |
| Daily status | End of each day | Email summary |
| Draft report | Within 5 business days | PDF |
| Final report | Within 5 days of review | PDF |
| Retest verification | Within 3 days of fixes | PDF addendum |

---

## 6. Acceptance Criteria

### 6.1 Vulnerability Severity Ratings

Use CVSS 3.1 with the following business context adjustments:

| CVSS Score | Base Rating | VERA Context |
|------------|-------------|--------------|
| 9.0-10.0 | Critical | Critical (mental health data) |
| 7.0-8.9 | High | High to Critical |
| 4.0-6.9 | Medium | Medium to High |
| 0.1-3.9 | Low | Low to Medium |
| 0.0 | Info | Informational |

**Context Multipliers:**
- User conversation data exposure: +1 severity level
- Authentication bypass: +1 severity level
- Multi-user impact: +1 severity level

### 6.2 Deliverables Expected

| Deliverable | Contents |
|-------------|----------|
| Executive Summary | 1-2 pages, non-technical overview |
| Risk Dashboard | Vulnerability counts by severity |
| Technical Findings | Detailed writeup per vulnerability |
| Proof of Concept | Reproducible steps, screenshots, requests |
| Remediation Guidance | Specific fix recommendations |
| Prioritized Roadmap | Suggested remediation order |
| Retest Results | Verification of fixes (if included) |

### 6.3 Report Format

```
1. Executive Summary
2. Scope and Methodology
3. Risk Summary Dashboard
4. Detailed Findings
   4.1 Finding Title
       - Severity (CVSS + Business)
       - Affected Asset
       - Description
       - Proof of Concept
       - Impact
       - Remediation
       - References
5. Remediation Roadmap
6. Appendices
   A. Testing Tools Used
   B. Request/Response Samples
   C. Methodology Details
```

---

## 7. Legal and Compliance

### 7.1 Authorization

This document, when signed, authorizes the named penetration testing firm to conduct security testing within the defined scope during the specified testing window.

### 7.2 Confidentiality

All findings, reports, and information obtained during testing are confidential and subject to NDA.

### 7.3 Data Handling

- Test data must be securely deleted within 30 days of engagement completion
- No real user data to be retained under any circumstances
- Report stored according to tester's security standards

---

## 8. Signatures

| Role | Name | Signature | Date |
|------|------|-----------|------|
| VERA Security Officer | _________________ | _________________ | _______ |
| VERA Engineering Lead | _________________ | _________________ | _______ |
| Testing Firm Representative | _________________ | _________________ | _______ |

---

## Appendix A: API Endpoint Inventory

See: [Full endpoint list to be generated from codebase]

## Appendix B: Authentication Flows

1. **Sign Up**: Email/password via Clerk
2. **Sign In**: Email/password or social OAuth
3. **MFA**: TOTP available via Clerk
4. **Session**: JWT with Clerk session management
5. **API Auth**: Bearer token from Clerk

## Appendix C: Data Flow Diagrams

[To be provided separately]

---

*This document is confidential. Distribution limited to authorized testing personnel.*
